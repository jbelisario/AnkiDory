## Project Overview: Dory - AI-Enhanced Anki

Dory is an innovative extension of the Anki flashcard system, designed to address the criticism that Anki can lead to memorizing isolated facts without understanding context. By integrating Large Language Models (LLMs), Dory aims to provide a more comprehensive learning experience that promotes deeper understanding and contextual learning.

## Core Functionalities

1. **"Guide Me" Feature**: This is the central innovation of Dory. When reviewing a flashcard, users can request hints generated by an LLM. These hints are designed to:
   - Provide context to the question
   - Guide users towards the answer without revealing it directly
   - Strengthen existing mental connections
   - Encourage deeper understanding of the material

2. **Contextual Learning**: The LLM will analyze the content of flashcards and provide additional information to help users understand the broader context of what they're learning.

3. **Intelligent Hint Generation**: The system will use the user's past performance and the difficulty of the card to tailor the level of hints provided.

4. **Progress Tracking**: Dory will track how often users rely on hints and how this affects their long-term retention, allowing for personalized learning strategies.

## Product Requirements Document

### 1. User Interface

- Implement a "Guide Me" button on the flashcard review screen
- Design a hint display area that can show multiple levels of hints
- Create a settings menu for users to customize hint frequency and detail

### 2. LLM Integration

- Develop an API to communicate with the chosen LLM (e.g., GPT-3.5 or GPT-4)
- Implement prompt engineering to generate context-appropriate hints
- Ensure proper error handling for API calls

### 3. Hint Generation Algorithm

- Create an algorithm that analyzes card content, user performance, and card difficulty
- Develop a system for generating multi-level hints, from subtle to more direct
- Implement a mechanism to avoid revealing the answer directly

### 4. Data Management

- Design a database schema to store hint usage and effectiveness
- Implement data collection for user interactions with the hint system
- Ensure user privacy and data security in hint generation and storage

### 5. Performance Optimization

- Optimize LLM API calls to minimize latency in hint generation
- Implement caching for frequently requested hints to reduce API usage

### 6. User Customization

- Allow users to set preferences for hint frequency and detail
- Provide options to disable the hint system for specific decks or cards

### 7. Feedback and Improvement

- Implement a feedback system for users to rate hint usefulness
- Design an analytics dashboard for developers to track hint effectiveness

## Current File Structure and Implementation Guide

The Anki source code is primarily written in Python and Rust, with a Qt-based user interface. Here's a simplified overview of the relevant parts of the file structure:

```
anki/
├── pylib/
│   ├── anki/
│   │   ├── cards.py
│   │   ├── decks.py
│   │   ├── models.py
│   │   └── scheduler/
├── qt/
│   ├── aqt/
│   │   ├── reviewer.py
│   │   └── main.py
├── rslib/
│   └── src/
│       ├── backend/
│       └── scheduler/
```

To implement the "Guide Me" feature:

1. **Backend (Rust)**:
   - Modify `rslib/src/backend/` to add new methods for hint generation and management
   - Update the scheduler in `rslib/src/scheduler/` to incorporate hint usage data

2. **Python Library**:
   - Extend `pylib/anki/cards.py` to include hint-related properties and methods
   - Update `pylib/anki/scheduler/` to integrate hint usage into the review process

3. **User Interface (Qt)**:
   - Modify `qt/aqt/reviewer.py` to add the "Guide Me" button and hint display area
   - Update `qt/aqt/main.py` to include new menu options for hint settings

4. **LLM Integration**:
   - Create a new module (e.g., `pylib/anki/llm.py`) to handle LLM API interactions
   - Implement caching and error handling in this module

5. **Database**:
   - Extend the existing database schema to store hint usage data and user preferences

By building upon the existing Anki architecture, Dory can seamlessly integrate AI-powered features while maintaining compatibility with the core Anki functionality[1][5].

Citations:
[1] https://github.com/ankitects/anki
[2] https://scholarly.so/blog/anki-pros-and-cons-of-using-spaced-repetition-software
[3] https://www.reddit.com/r/Anki/comments/1fbqoky/whats_your_opinion_of_using_llm_to_create/
[4] https://www.bridgetext.com/using-anki-for-memorization
[5] https://github.com/ankitects/anki
[6] https://pmc.ncbi.nlm.nih.gov/articles/PMC10551781/# Guide Me Feature Documentation

